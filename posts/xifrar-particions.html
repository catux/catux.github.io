<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Associació d'usuaris de GNU/Linux de la Catalunya Central">
    <meta name="keywords" content="gnu/linux, linux, programari lliure, gnu, lug, associacio, manresa, sant joan de vilatorrada, catalan, català, catalunya">
    <meta name="author" content="Catux">
    <link rel="icon" href="https://catux.org/images/favicon.ico">

    <title>Catux - Associació d'usuaris de GNU/Linux de la Catalunya Central</title>

    <!-- Bootstrap 5 CSS is included in main.css -->
    <link rel="stylesheet" type="text/css" href="https://catux.org/css/main.css">
    <!-- Bootstrap 5 JS and dependencies are included in main.js -->
    <script src="https://catux.org/js/main.js" defer></script>
</head>
<body>
    <header class="sticky-top">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark py-3">
            <div class="container-fluid">
                <a class="navbar-brand" href="https://catux.org/">
                    <img src="https://catux.org/images/catuxlogo.png" alt="Catux" height="50" class="me-3">
                    <div class="d-none d-lg-block d-xl-none">Associació d'usuaris de GNU/Linux de la Catalunya Central</div>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div id="navbarMain" class="collapse navbar-collapse">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link px-3" href="https://catux.org/post_list.html">Blog</a></li>
                        <li class="nav-item"><a class="nav-link px-3" href="https://catux.org/traduccio.html">Traducció</a></li>
                        <li class="nav-item"><a class="nav-link px-3" href="https://catux.org/contactar.html">Contactar</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container main-container">
        
    <div class="container-fluid">

        <div class="post">
            <a href="https://catux.org/post_list.html">
                <i class="fas fa-chevron-left"></i>
                Arxius
            </a>

            <h1>
                
        Xifrar particions
    
            </h1>

            <h3>
                Escrit al
                
        2008-11-02 13:43:34
    
                per
                
        cpina
    
            </h3>

            <p>
                
        <p>En aquesta entrada s'explicarà com xifrar els sistemes de fitxers. Un cop fet cal introduir una contrasenya quan es munta el sistema de fitxers. Quan ja està muntat el sistema de fitxers es fan les operacions de xifrar i de-xifrar al vol i queda totalment transparent a l'usuari (no notem que està xifrat). A les proves que vaig fer, el rendiment de lectura/escriptura és molt semblant.</p><p>El motiu de xifrar alguns sistemes de fitxers és evitar que, si perdem o ens roben el portàtil, no es pugui accedir tant fàcilment als nostres fitxers. Una bona manera de fer proves és xifrant algun disc USB.</p><p>No he fet proves xifrant la partició / (sí, la HOME). Xifrar la partició / és més problemàtic, no ho he provat i no és tant necessari: podem evitar que hi hagi dades personals i que només hi hagi fitxers del sistema.  </p><p>Hi ha altres maneres de xifrar les particions, aquí mostraré els passos utilitzant crypsetup i <a href="http://luks.endorphin.org/">luks</a> (Linux Unified Key Setup). </p><p>Les proves són amb les comandes més bàsiques.  Fa mesos que faig servir aquest sistema, i és molt fàcil d'accedir a les dades des de diferents ordinadors Linux, diferents distribucions, etc.  </p><h1>Instruccions</h1><p> Primer preparem la partició pel format luks. Aquí s'ens demanarà la contrasenya:</p><pre>cryptsetup --verbose --verify-passphrase luksFormat /dev/sdX1</pre><p>(fent això és perderà tot el què hi hagi a sdX1!)  Obrim la partició i la deixem desencriptada com si fos un "Device Mapper":</p><pre>cryptsetup luksOpen /dev/sdX1 xifrat</pre><p>A partir d'ara, tenim a /dev/mapper/xifrat un dispositiu que hem d'accedir per fer servir la partició ja desencriptada.</p><p>Per tant, la podem formatejar:</p><pre>mkfs -t xfs /dev/mapper/xifrat</pre><p>I muntar de forma normal:</p><pre>mkdir /mnt/xifrat mount /dev/mapper/xifrat /mnt/xifrat/</pre><p>A partir d'aquí tenim el sistema de fitxers a /mnt/xifrat  Si volem desmontar, hem de desmontar el sistema de fitxers: </p><pre>umount /mnt/xifrat  </pre><p>I després tancar el luks: </p><pre>cryptsetup luksClose /dev/sdX1 </pre><p>Podem demanar informació: </p><pre>cryptsetup status xifrat  </pre><h1>A l'arranc</h1><p> Si volem que una partició xifrada es monti a l'arranc (demanant la contrasenya, clar) hem d'escriure a /etc/crypttab:</p><pre>home    /dev/sda6               none            luks</pre><p>Això ens demanarà la contrasenya per /dev/sda6 i ho deixarà a /dev/mapper/home. Al /etc/fstab cal tenir-hi:  </p><pre>/dev/mapper/home        /home   xfs     defaults        0       2  </pre><h1>Script per montar un disc extraible</h1><p>Aquest apartat és totalment opcional. A més, no és exclusiu per particions xifrades. </p><p>No volia haver de remanar  crypttab o fstab per alguns discs USB, així que vaig fer algun script com ara:  </p><pre>#!/bin/bash</pre><pre>cryptsetup luksOpen /dev/disk/by-uuid/ef5eeaaf-39df-45bf-9492-XXXXXXX disc_gros</pre><pre>mount /dev/mapper/disc_gros</pre><p>Per saber el uuid (identificador "únic") podem endollar el disc USB i llavors fer:</p><pre>ls -la /dev/disk/by-uuid/</pre><p>I ens fixem quin fitxer UUID enllaça cap a la partició que volem. Així no hem d'estar pendents de si ara el disc és sdb1 o sdc1 (en funció de què l'ordre que es connecta).  </p><p>L'script per desmontar:</p><pre>#!/bin/bash</pre><pre>umount /mnt/disc_gros</pre><pre>cryptsetup luksClose /dev/mapper/disc_gros </pre>
    
            </p>

            <h3>
                Categories:
                
        Articles, Trucs
    
            </h3>

            <hr />
            <h1>Comentaris</h1>
            <ul class="list-group">
                
        <li class="list-group-item">Sense comentaris</li>
    
            </ul>


            <a href="https://catux.org/post_list.html">
                <i class="fas fa-chevron-left"></i>
                Arxius
            </a>
        </div>

    </div>


    </div> <!-- /.container -->

    <footer class="bg-dark text-light py-4 mt-5 fixed-bottom">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <p class="mb-0">
                        <small><small>Tot el contingut de Catux està subjecte sota la nova versió de la llicència de
                        <a href="http://creativecommons.org/licenses/by/2.5/es/deed.ca" class="text-light">Creative Commons</a></small></small>
                    </p>
                </div>
                <div class="col-md-4 text-md-end">
                    <p class="mb-0">
                        <a href="https://github.com/catux" class="text-light me-3"><i class="fab fa-github"></i></a>
                        <a href="https://t.me/+UaRevB06YidmYTY0" class="text-light"><i class="fab fa-telegram"></i></a>
                    </p>
                </div>
            </div>
        </div>
    </footer>



</body>
</html>
